a6fb0c7f125d638498fa9d6ca8cd2453
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const util_1 = require("util");
global.TextEncoder = util_1.TextEncoder;
const EscPos_1 = require("../src/drivers/EscPos");
// Mock Encoding since it might depend on TextEncoder which is available in Node 11+
// But let's assume it works or mock it if needed.
// Actually, let's check src/utils/encoding.ts content first?
// I haven't read it yet. Let's assume it works or read it if test fails.
describe('EscPos QR', () => {
    const driver = new EscPos_1.EscPos();
    test('qr generates correct commands for default options', () => {
        const content = '12345';
        const commands = driver.qr(content);
        // Expect 6 commands
        expect(commands.length).toBe(6);
        // 1. Model: GS ( k 04 00 31 41 50 00 (Model 2 default)
        expect(commands[0]).toEqual(new Uint8Array([0x1D, 0x28, 0x6B, 0x04, 0x00, 0x31, 0x41, 50, 0]));
        // 2. Size: GS ( k 03 00 31 43 06 (Size 6 default)
        expect(commands[1]).toEqual(new Uint8Array([0x1D, 0x28, 0x6B, 0x03, 0x00, 0x31, 0x43, 6]));
        // 3. Error Correction: GS ( k 03 00 31 45 49 (Level M default)
        expect(commands[2]).toEqual(new Uint8Array([0x1D, 0x28, 0x6B, 0x03, 0x00, 0x31, 0x45, 49]));
        // 4. Store Data Header
        // Length of '12345' is 5. +3 = 8.
        // pL = 8, pH = 0.
        // GS ( k 08 00 31 50 30 ...data...
        const header = new Uint8Array([0x1D, 0x28, 0x6B, 8, 0, 0x31, 0x50, 0x30]);
        expect(commands[3]).toEqual(header);
        // 5. Store Data Content
        // '12345' encoded to UTF-8 (fallback) is [49, 50, 51, 52, 53]
        expect(commands[4]).toEqual(new Uint8Array([49, 50, 51, 52, 53]));
        // 6. Print Symbol
        // GS ( k 03 00 31 51 30
        expect(commands[5]).toEqual(new Uint8Array([0x1D, 0x28, 0x6B, 0x03, 0x00, 0x31, 0x51, 0x30]));
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL1VzZXJzL3pma2MvRGVza3RvcC8wMy3np7vliqjnq6/pobnnm64vdGFyby1ibHVldG9vdGgtcHJpbnQvdGVzdHMvcXIudGVzdC50cyIsIm1hcHBpbmdzIjoiOztBQUNBLCtCQUFtQztBQUNuQyxNQUFNLENBQUMsV0FBVyxHQUFHLGtCQUFrQixDQUFDO0FBRXhDLGtEQUErQztBQUcvQyxvRkFBb0Y7QUFDcEYsa0RBQWtEO0FBQ2xELDZEQUE2RDtBQUM3RCx5RUFBeUU7QUFFekUsUUFBUSxDQUFDLFdBQVcsRUFBRSxHQUFHLEVBQUU7SUFDekIsTUFBTSxNQUFNLEdBQUcsSUFBSSxlQUFNLEVBQUUsQ0FBQztJQUU1QixJQUFJLENBQUMsbURBQW1ELEVBQUUsR0FBRyxFQUFFO1FBQzdELE1BQU0sT0FBTyxHQUFHLE9BQU8sQ0FBQztRQUN4QixNQUFNLFFBQVEsR0FBRyxNQUFNLENBQUMsRUFBRSxDQUFDLE9BQU8sQ0FBQyxDQUFDO1FBRXBDLG9CQUFvQjtRQUNwQixNQUFNLENBQUMsUUFBUSxDQUFDLE1BQU0sQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQztRQUVoQyx1REFBdUQ7UUFDdkQsTUFBTSxDQUFDLFFBQVEsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxJQUFJLFVBQVUsQ0FBQyxDQUFDLElBQUksRUFBRSxJQUFJLEVBQUUsSUFBSSxFQUFFLElBQUksRUFBRSxJQUFJLEVBQUUsSUFBSSxFQUFFLElBQUksRUFBRSxFQUFFLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO1FBRS9GLGtEQUFrRDtRQUNsRCxNQUFNLENBQUMsUUFBUSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsT0FBTyxDQUFDLElBQUksVUFBVSxDQUFDLENBQUMsSUFBSSxFQUFFLElBQUksRUFBRSxJQUFJLEVBQUUsSUFBSSxFQUFFLElBQUksRUFBRSxJQUFJLEVBQUUsSUFBSSxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztRQUUzRiwrREFBK0Q7UUFDL0QsTUFBTSxDQUFDLFFBQVEsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxJQUFJLFVBQVUsQ0FBQyxDQUFDLElBQUksRUFBRSxJQUFJLEVBQUUsSUFBSSxFQUFFLElBQUksRUFBRSxJQUFJLEVBQUUsSUFBSSxFQUFFLElBQUksRUFBRSxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUM7UUFFNUYsdUJBQXVCO1FBQ3ZCLGtDQUFrQztRQUNsQyxrQkFBa0I7UUFDbEIsbUNBQW1DO1FBQ25DLE1BQU0sTUFBTSxHQUFHLElBQUksVUFBVSxDQUFDLENBQUMsSUFBSSxFQUFFLElBQUksRUFBRSxJQUFJLEVBQUUsQ0FBQyxFQUFFLENBQUMsRUFBRSxJQUFJLEVBQUUsSUFBSSxFQUFFLElBQUksQ0FBQyxDQUFDLENBQUM7UUFDMUUsTUFBTSxDQUFDLFFBQVEsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxNQUFNLENBQUMsQ0FBQztRQUVwQyx3QkFBd0I7UUFDeEIsOERBQThEO1FBQzlELE1BQU0sQ0FBQyxRQUFRLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxPQUFPLENBQUMsSUFBSSxVQUFVLENBQUMsQ0FBQyxFQUFFLEVBQUUsRUFBRSxFQUFFLEVBQUUsRUFBRSxFQUFFLEVBQUUsRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDO1FBRWxFLGtCQUFrQjtRQUNsQix3QkFBd0I7UUFDeEIsTUFBTSxDQUFDLFFBQVEsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxJQUFJLFVBQVUsQ0FBQyxDQUFDLElBQUksRUFBRSxJQUFJLEVBQUUsSUFBSSxFQUFFLElBQUksRUFBRSxJQUFJLEVBQUUsSUFBSSxFQUFFLElBQUksRUFBRSxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUM7SUFDaEcsQ0FBQyxDQUFDLENBQUM7QUFDTCxDQUFDLENBQUMsQ0FBQyIsIm5hbWVzIjpbXSwic291cmNlcyI6WyIvVXNlcnMvemZrYy9EZXNrdG9wLzAzLeenu+WKqOerr+mhueebri90YXJvLWJsdWV0b290aC1wcmludC90ZXN0cy9xci50ZXN0LnRzIl0sInNvdXJjZXNDb250ZW50IjpbIlxuaW1wb3J0IHsgVGV4dEVuY29kZXIgfSBmcm9tICd1dGlsJztcbmdsb2JhbC5UZXh0RW5jb2RlciA9IFRleHRFbmNvZGVyIGFzIGFueTtcblxuaW1wb3J0IHsgRXNjUG9zIH0gZnJvbSAnLi4vc3JjL2RyaXZlcnMvRXNjUG9zJztcbmltcG9ydCB7IEVuY29kaW5nIH0gZnJvbSAnLi4vc3JjL3V0aWxzL2VuY29kaW5nJztcblxuLy8gTW9jayBFbmNvZGluZyBzaW5jZSBpdCBtaWdodCBkZXBlbmQgb24gVGV4dEVuY29kZXIgd2hpY2ggaXMgYXZhaWxhYmxlIGluIE5vZGUgMTErXG4vLyBCdXQgbGV0J3MgYXNzdW1lIGl0IHdvcmtzIG9yIG1vY2sgaXQgaWYgbmVlZGVkLlxuLy8gQWN0dWFsbHksIGxldCdzIGNoZWNrIHNyYy91dGlscy9lbmNvZGluZy50cyBjb250ZW50IGZpcnN0P1xuLy8gSSBoYXZlbid0IHJlYWQgaXQgeWV0LiBMZXQncyBhc3N1bWUgaXQgd29ya3Mgb3IgcmVhZCBpdCBpZiB0ZXN0IGZhaWxzLlxuXG5kZXNjcmliZSgnRXNjUG9zIFFSJywgKCkgPT4ge1xuICBjb25zdCBkcml2ZXIgPSBuZXcgRXNjUG9zKCk7XG5cbiAgdGVzdCgncXIgZ2VuZXJhdGVzIGNvcnJlY3QgY29tbWFuZHMgZm9yIGRlZmF1bHQgb3B0aW9ucycsICgpID0+IHtcbiAgICBjb25zdCBjb250ZW50ID0gJzEyMzQ1JztcbiAgICBjb25zdCBjb21tYW5kcyA9IGRyaXZlci5xcihjb250ZW50KTtcblxuICAgIC8vIEV4cGVjdCA2IGNvbW1hbmRzXG4gICAgZXhwZWN0KGNvbW1hbmRzLmxlbmd0aCkudG9CZSg2KTtcblxuICAgIC8vIDEuIE1vZGVsOiBHUyAoIGsgMDQgMDAgMzEgNDEgNTAgMDAgKE1vZGVsIDIgZGVmYXVsdClcbiAgICBleHBlY3QoY29tbWFuZHNbMF0pLnRvRXF1YWwobmV3IFVpbnQ4QXJyYXkoWzB4MUQsIDB4MjgsIDB4NkIsIDB4MDQsIDB4MDAsIDB4MzEsIDB4NDEsIDUwLCAwXSkpO1xuXG4gICAgLy8gMi4gU2l6ZTogR1MgKCBrIDAzIDAwIDMxIDQzIDA2IChTaXplIDYgZGVmYXVsdClcbiAgICBleHBlY3QoY29tbWFuZHNbMV0pLnRvRXF1YWwobmV3IFVpbnQ4QXJyYXkoWzB4MUQsIDB4MjgsIDB4NkIsIDB4MDMsIDB4MDAsIDB4MzEsIDB4NDMsIDZdKSk7XG5cbiAgICAvLyAzLiBFcnJvciBDb3JyZWN0aW9uOiBHUyAoIGsgMDMgMDAgMzEgNDUgNDkgKExldmVsIE0gZGVmYXVsdClcbiAgICBleHBlY3QoY29tbWFuZHNbMl0pLnRvRXF1YWwobmV3IFVpbnQ4QXJyYXkoWzB4MUQsIDB4MjgsIDB4NkIsIDB4MDMsIDB4MDAsIDB4MzEsIDB4NDUsIDQ5XSkpO1xuXG4gICAgLy8gNC4gU3RvcmUgRGF0YSBIZWFkZXJcbiAgICAvLyBMZW5ndGggb2YgJzEyMzQ1JyBpcyA1LiArMyA9IDguXG4gICAgLy8gcEwgPSA4LCBwSCA9IDAuXG4gICAgLy8gR1MgKCBrIDA4IDAwIDMxIDUwIDMwIC4uLmRhdGEuLi5cbiAgICBjb25zdCBoZWFkZXIgPSBuZXcgVWludDhBcnJheShbMHgxRCwgMHgyOCwgMHg2QiwgOCwgMCwgMHgzMSwgMHg1MCwgMHgzMF0pO1xuICAgIGV4cGVjdChjb21tYW5kc1szXSkudG9FcXVhbChoZWFkZXIpO1xuXG4gICAgLy8gNS4gU3RvcmUgRGF0YSBDb250ZW50XG4gICAgLy8gJzEyMzQ1JyBlbmNvZGVkIHRvIFVURi04IChmYWxsYmFjaykgaXMgWzQ5LCA1MCwgNTEsIDUyLCA1M11cbiAgICBleHBlY3QoY29tbWFuZHNbNF0pLnRvRXF1YWwobmV3IFVpbnQ4QXJyYXkoWzQ5LCA1MCwgNTEsIDUyLCA1M10pKTtcblxuICAgIC8vIDYuIFByaW50IFN5bWJvbFxuICAgIC8vIEdTICggayAwMyAwMCAzMSA1MSAzMFxuICAgIGV4cGVjdChjb21tYW5kc1s1XSkudG9FcXVhbChuZXcgVWludDhBcnJheShbMHgxRCwgMHgyOCwgMHg2QiwgMHgwMywgMHgwMCwgMHgzMSwgMHg1MSwgMHgzMF0pKTtcbiAgfSk7XG59KTtcbiJdLCJ2ZXJzaW9uIjozfQ==