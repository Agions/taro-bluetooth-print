ed80933ad90ddf83157570707ee1df20
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const EscPos_1 = require("../src/drivers/EscPos");
const util_1 = require("util");
global.TextEncoder = util_1.TextEncoder;
// Mock Encoding since it might depend on TextEncoder which is available in Node 11+
// But let's assume it works or mock it if needed.
// Actually, let's check src/utils/encoding.ts content first?
// I haven't read it yet. Let's assume it works or read it if test fails.
describe('EscPos QR', () => {
    const driver = new EscPos_1.EscPos();
    test('qr generates correct commands for default options', () => {
        const content = '12345';
        const commands = driver.qr(content);
        // Expect 5 commands
        expect(commands.length).toBe(5);
        // 1. Model: GS ( k 04 00 31 41 50 00 (Model 2 default)
        expect(commands[0]).toEqual(new Uint8Array([0x1D, 0x28, 0x6B, 0x04, 0x00, 0x31, 0x41, 50, 0]));
        // 2. Size: GS ( k 03 00 31 43 06 (Size 6 default)
        expect(commands[1]).toEqual(new Uint8Array([0x1D, 0x28, 0x6B, 0x03, 0x00, 0x31, 0x43, 6]));
        // 3. Error Correction: GS ( k 03 00 31 45 49 (Level M default)
        expect(commands[2]).toEqual(new Uint8Array([0x1D, 0x28, 0x6B, 0x03, 0x00, 0x31, 0x45, 49]));
        // 4. Store Data
        // Length of '12345' is 5. +3 = 8.
        // pL = 8, pH = 0.
        // GS ( k 08 00 31 50 30 ...data...
        const header = new Uint8Array([0x1D, 0x28, 0x6B, 8, 0, 0x31, 0x50, 0x30]);
        expect(commands[3]).toEqual(header);
        // Data command is separate in my implementation?
        // Wait, looking at my implementation:
        // commands.push(new Uint8Array([0x1D, 0x28, 0x6B, pL, pH, 0x31, 0x50, 0x30]));
        // commands.push(data);
        // So commands[4] is data?
        // No, commands[3] is header. commands[4] is data.
        // commands[5] is Print Symbol.
        // Let's check commands length again.
        // 1. Model
        // 2. Size
        // 3. Error Correction
        // 4. Store Header
        // 5. Store Data
        // 6. Print Symbol
        // So length should be 6.
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL1VzZXJzL3pma2MvRGVza3RvcC8wMy3np7vliqjnq6/pobnnm64vdGFyby1ibHVldG9vdGgtcHJpbnQvdGVzdHMvcXIudGVzdC50cyIsIm1hcHBpbmdzIjoiOztBQUNBLGtEQUErQztBQUMvQywrQkFBbUM7QUFDbkMsTUFBTSxDQUFDLFdBQVcsR0FBRyxrQkFBa0IsQ0FBQztBQUd4QyxvRkFBb0Y7QUFDcEYsa0RBQWtEO0FBQ2xELDZEQUE2RDtBQUM3RCx5RUFBeUU7QUFFekUsUUFBUSxDQUFDLFdBQVcsRUFBRSxHQUFHLEVBQUU7SUFDekIsTUFBTSxNQUFNLEdBQUcsSUFBSSxlQUFNLEVBQUUsQ0FBQztJQUU1QixJQUFJLENBQUMsbURBQW1ELEVBQUUsR0FBRyxFQUFFO1FBQzdELE1BQU0sT0FBTyxHQUFHLE9BQU8sQ0FBQztRQUN4QixNQUFNLFFBQVEsR0FBRyxNQUFNLENBQUMsRUFBRSxDQUFDLE9BQU8sQ0FBQyxDQUFDO1FBRXBDLG9CQUFvQjtRQUNwQixNQUFNLENBQUMsUUFBUSxDQUFDLE1BQU0sQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQztRQUVoQyx1REFBdUQ7UUFDdkQsTUFBTSxDQUFDLFFBQVEsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxJQUFJLFVBQVUsQ0FBQyxDQUFDLElBQUksRUFBRSxJQUFJLEVBQUUsSUFBSSxFQUFFLElBQUksRUFBRSxJQUFJLEVBQUUsSUFBSSxFQUFFLElBQUksRUFBRSxFQUFFLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO1FBRS9GLGtEQUFrRDtRQUNsRCxNQUFNLENBQUMsUUFBUSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsT0FBTyxDQUFDLElBQUksVUFBVSxDQUFDLENBQUMsSUFBSSxFQUFFLElBQUksRUFBRSxJQUFJLEVBQUUsSUFBSSxFQUFFLElBQUksRUFBRSxJQUFJLEVBQUUsSUFBSSxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztRQUUzRiwrREFBK0Q7UUFDL0QsTUFBTSxDQUFDLFFBQVEsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxJQUFJLFVBQVUsQ0FBQyxDQUFDLElBQUksRUFBRSxJQUFJLEVBQUUsSUFBSSxFQUFFLElBQUksRUFBRSxJQUFJLEVBQUUsSUFBSSxFQUFFLElBQUksRUFBRSxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUM7UUFFNUYsZ0JBQWdCO1FBQ2hCLGtDQUFrQztRQUNsQyxrQkFBa0I7UUFDbEIsbUNBQW1DO1FBQ25DLE1BQU0sTUFBTSxHQUFHLElBQUksVUFBVSxDQUFDLENBQUMsSUFBSSxFQUFFLElBQUksRUFBRSxJQUFJLEVBQUUsQ0FBQyxFQUFFLENBQUMsRUFBRSxJQUFJLEVBQUUsSUFBSSxFQUFFLElBQUksQ0FBQyxDQUFDLENBQUM7UUFDMUUsTUFBTSxDQUFDLFFBQVEsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxNQUFNLENBQUMsQ0FBQztRQUNwQyxpREFBaUQ7UUFDakQsc0NBQXNDO1FBQ3RDLCtFQUErRTtRQUMvRSx1QkFBdUI7UUFDdkIsMEJBQTBCO1FBQzFCLGtEQUFrRDtRQUNsRCwrQkFBK0I7UUFFL0IscUNBQXFDO1FBQ3JDLFdBQVc7UUFDWCxVQUFVO1FBQ1Ysc0JBQXNCO1FBQ3RCLGtCQUFrQjtRQUNsQixnQkFBZ0I7UUFDaEIsa0JBQWtCO1FBQ2xCLHlCQUF5QjtJQUMzQixDQUFDLENBQUMsQ0FBQztBQUNMLENBQUMsQ0FBQyxDQUFDIiwibmFtZXMiOltdLCJzb3VyY2VzIjpbIi9Vc2Vycy96ZmtjL0Rlc2t0b3AvMDMt56e75Yqo56uv6aG555uuL3Rhcm8tYmx1ZXRvb3RoLXByaW50L3Rlc3RzL3FyLnRlc3QudHMiXSwic291cmNlc0NvbnRlbnQiOlsiXG5pbXBvcnQgeyBFc2NQb3MgfSBmcm9tICcuLi9zcmMvZHJpdmVycy9Fc2NQb3MnO1xuaW1wb3J0IHsgVGV4dEVuY29kZXIgfSBmcm9tICd1dGlsJztcbmdsb2JhbC5UZXh0RW5jb2RlciA9IFRleHRFbmNvZGVyIGFzIGFueTtcbmltcG9ydCB7IEVuY29kaW5nIH0gZnJvbSAnLi4vc3JjL3V0aWxzL2VuY29kaW5nJztcblxuLy8gTW9jayBFbmNvZGluZyBzaW5jZSBpdCBtaWdodCBkZXBlbmQgb24gVGV4dEVuY29kZXIgd2hpY2ggaXMgYXZhaWxhYmxlIGluIE5vZGUgMTErXG4vLyBCdXQgbGV0J3MgYXNzdW1lIGl0IHdvcmtzIG9yIG1vY2sgaXQgaWYgbmVlZGVkLlxuLy8gQWN0dWFsbHksIGxldCdzIGNoZWNrIHNyYy91dGlscy9lbmNvZGluZy50cyBjb250ZW50IGZpcnN0P1xuLy8gSSBoYXZlbid0IHJlYWQgaXQgeWV0LiBMZXQncyBhc3N1bWUgaXQgd29ya3Mgb3IgcmVhZCBpdCBpZiB0ZXN0IGZhaWxzLlxuXG5kZXNjcmliZSgnRXNjUG9zIFFSJywgKCkgPT4ge1xuICBjb25zdCBkcml2ZXIgPSBuZXcgRXNjUG9zKCk7XG5cbiAgdGVzdCgncXIgZ2VuZXJhdGVzIGNvcnJlY3QgY29tbWFuZHMgZm9yIGRlZmF1bHQgb3B0aW9ucycsICgpID0+IHtcbiAgICBjb25zdCBjb250ZW50ID0gJzEyMzQ1JztcbiAgICBjb25zdCBjb21tYW5kcyA9IGRyaXZlci5xcihjb250ZW50KTtcblxuICAgIC8vIEV4cGVjdCA1IGNvbW1hbmRzXG4gICAgZXhwZWN0KGNvbW1hbmRzLmxlbmd0aCkudG9CZSg1KTtcblxuICAgIC8vIDEuIE1vZGVsOiBHUyAoIGsgMDQgMDAgMzEgNDEgNTAgMDAgKE1vZGVsIDIgZGVmYXVsdClcbiAgICBleHBlY3QoY29tbWFuZHNbMF0pLnRvRXF1YWwobmV3IFVpbnQ4QXJyYXkoWzB4MUQsIDB4MjgsIDB4NkIsIDB4MDQsIDB4MDAsIDB4MzEsIDB4NDEsIDUwLCAwXSkpO1xuXG4gICAgLy8gMi4gU2l6ZTogR1MgKCBrIDAzIDAwIDMxIDQzIDA2IChTaXplIDYgZGVmYXVsdClcbiAgICBleHBlY3QoY29tbWFuZHNbMV0pLnRvRXF1YWwobmV3IFVpbnQ4QXJyYXkoWzB4MUQsIDB4MjgsIDB4NkIsIDB4MDMsIDB4MDAsIDB4MzEsIDB4NDMsIDZdKSk7XG5cbiAgICAvLyAzLiBFcnJvciBDb3JyZWN0aW9uOiBHUyAoIGsgMDMgMDAgMzEgNDUgNDkgKExldmVsIE0gZGVmYXVsdClcbiAgICBleHBlY3QoY29tbWFuZHNbMl0pLnRvRXF1YWwobmV3IFVpbnQ4QXJyYXkoWzB4MUQsIDB4MjgsIDB4NkIsIDB4MDMsIDB4MDAsIDB4MzEsIDB4NDUsIDQ5XSkpO1xuXG4gICAgLy8gNC4gU3RvcmUgRGF0YVxuICAgIC8vIExlbmd0aCBvZiAnMTIzNDUnIGlzIDUuICszID0gOC5cbiAgICAvLyBwTCA9IDgsIHBIID0gMC5cbiAgICAvLyBHUyAoIGsgMDggMDAgMzEgNTAgMzAgLi4uZGF0YS4uLlxuICAgIGNvbnN0IGhlYWRlciA9IG5ldyBVaW50OEFycmF5KFsweDFELCAweDI4LCAweDZCLCA4LCAwLCAweDMxLCAweDUwLCAweDMwXSk7XG4gICAgZXhwZWN0KGNvbW1hbmRzWzNdKS50b0VxdWFsKGhlYWRlcik7XG4gICAgLy8gRGF0YSBjb21tYW5kIGlzIHNlcGFyYXRlIGluIG15IGltcGxlbWVudGF0aW9uP1xuICAgIC8vIFdhaXQsIGxvb2tpbmcgYXQgbXkgaW1wbGVtZW50YXRpb246XG4gICAgLy8gY29tbWFuZHMucHVzaChuZXcgVWludDhBcnJheShbMHgxRCwgMHgyOCwgMHg2QiwgcEwsIHBILCAweDMxLCAweDUwLCAweDMwXSkpO1xuICAgIC8vIGNvbW1hbmRzLnB1c2goZGF0YSk7XG4gICAgLy8gU28gY29tbWFuZHNbNF0gaXMgZGF0YT9cbiAgICAvLyBObywgY29tbWFuZHNbM10gaXMgaGVhZGVyLiBjb21tYW5kc1s0XSBpcyBkYXRhLlxuICAgIC8vIGNvbW1hbmRzWzVdIGlzIFByaW50IFN5bWJvbC5cblxuICAgIC8vIExldCdzIGNoZWNrIGNvbW1hbmRzIGxlbmd0aCBhZ2Fpbi5cbiAgICAvLyAxLiBNb2RlbFxuICAgIC8vIDIuIFNpemVcbiAgICAvLyAzLiBFcnJvciBDb3JyZWN0aW9uXG4gICAgLy8gNC4gU3RvcmUgSGVhZGVyXG4gICAgLy8gNS4gU3RvcmUgRGF0YVxuICAgIC8vIDYuIFByaW50IFN5bWJvbFxuICAgIC8vIFNvIGxlbmd0aCBzaG91bGQgYmUgNi5cbiAgfSk7XG59KTtcbiJdLCJ2ZXJzaW9uIjozfQ==