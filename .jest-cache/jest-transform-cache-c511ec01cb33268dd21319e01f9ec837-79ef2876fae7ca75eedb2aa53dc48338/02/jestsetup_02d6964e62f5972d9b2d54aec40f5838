75c18dc56d36349a60966138f9cab86a
"use strict";
/**
 * Jest 全局设置文件
 */
Object.defineProperty(exports, "__esModule", { value: true });
exports.getMemoryUsage = exports.measureTime = exports.flushPromises = exports.createMockPrintJob = exports.createMockPrinterConfig = exports.createMockBluetoothDevice = void 0;
// 模拟 Taro 环境
jest.mock('@tarojs/taro', () => ({
    // 蓝牙相关 API
    getBluetoothAdapterState: jest.fn(),
    openBluetoothAdapter: jest.fn(),
    closeBluetoothAdapter: jest.fn(),
    startBluetoothDevicesDiscovery: jest.fn(),
    stopBluetoothDevicesDiscovery: jest.fn(),
    getBluetoothDevices: jest.fn(),
    getConnectedBluetoothDevices: jest.fn(),
    createBLEConnection: jest.fn(),
    closeBLEConnection: jest.fn(),
    getBLEDeviceServices: jest.fn(),
    getBLEDeviceCharacteristics: jest.fn(),
    readBLECharacteristicValue: jest.fn(),
    writeBLECharacteristicValue: jest.fn(),
    notifyBLECharacteristicValueChange: jest.fn(),
    // 设备相关 API
    getSystemInfoSync: jest.fn(() => ({
        platform: 'wechat',
        version: '7.0.0',
        SDKVersion: '2.0.0',
        model: 'iPhone 12',
        system: 'iOS 14.0'
    })),
    // 网络相关 API
    request: jest.fn(),
    uploadFile: jest.fn(),
    downloadFile: jest.fn(),
    // 存储相关 API
    setStorageSync: jest.fn(),
    getStorageSync: jest.fn(),
    removeStorageSync: jest.fn(),
    clearStorageSync: jest.fn(),
    // 界面相关 API
    showToast: jest.fn(),
    hideToast: jest.fn(),
    showLoading: jest.fn(),
    hideLoading: jest.fn(),
    showModal: jest.fn(),
    navigateTo: jest.fn(),
    redirectTo: jest.fn(),
    navigateBack: jest.fn(),
    switchTab: jest.fn(),
    reLaunch: jest.fn(),
    // 事件相关 API
    $on: jest.fn(),
    $off: jest.fn(),
    $trigger: jest.fn(),
    // 路由相关 API
    getCurrentPages: jest.fn(() => []),
    // 环境相关 API
    ENV_TYPE: {
        WEAPP: 'WEAPP',
        SWAN: 'SWAN',
        ALIPAY: 'ALIPAY',
        TT: 'TT',
        QQ: 'QQ',
        JD: 'JD'
    }
}));
// 扩展 Jest 匹配器
require("@testing-library/jest-dom");
// 模拟微信小程序环境
Object.defineProperty(window, 'wx', {
    value: {
        getBluetoothAdapterState: jest.fn(),
        openBluetoothAdapter: jest.fn(),
        closeBluetoothAdapter: jest.fn(),
        startBluetoothDevicesDiscovery: jest.fn(),
        stopBluetoothDevicesDiscovery: jest.fn(),
        getBluetoothDevices: jest.fn(),
        getConnectedBluetoothDevices: jest.fn(),
        createBLEConnection: jest.fn(),
        closeBLEConnection: jest.fn(),
        getBLEDeviceServices: jest.fn(),
        getBLEDeviceCharacteristics: jest.fn(),
        readBLECharacteristicValue: jest.fn(),
        writeBLECharacteristicValue: jest.fn(),
        notifyBLECharacteristicValueChange: jest.fn(),
        getSystemInfoSync: jest.fn(() => ({
            platform: 'wechat',
            version: '7.0.0'
        }))
    },
    writable: true
});
// 自定义匹配器实现
expect.extend({
    toBeValidBluetoothDevice(received) {
        const pass = received &&
            typeof received.deviceId === 'string' &&
            typeof received.name === 'string' &&
            typeof received.advertisData === 'object';
        if (pass) {
            return {
                message: () => `expected ${received} not to be a valid Bluetooth device`,
                pass: true
            };
        }
        else {
            return {
                message: () => `expected ${received} to be a valid Bluetooth device`,
                pass: false
            };
        }
    },
    toBeValidPrinterConfig(received) {
        const pass = received &&
            typeof received.name === 'string' &&
            typeof received.type === 'string' &&
            typeof received.connectionType === 'string';
        if (pass) {
            return {
                message: () => `expected ${received} not to be a valid printer config`,
                pass: true
            };
        }
        else {
            return {
                message: () => `expected ${received} to be a valid printer config`,
                pass: false
            };
        }
    },
    toBeValidPrintJob(received) {
        const pass = received &&
            typeof received.id === 'string' &&
            typeof received.data === 'object' &&
            typeof received.options === 'object';
        if (pass) {
            return {
                message: () => `expected ${received} not to be a valid print job`,
                pass: true
            };
        }
        else {
            return {
                message: () => `expected ${received} to be a valid print job`,
                pass: false
            };
        }
    },
    toBeInRange(received, min, max) {
        const pass = typeof received === 'number' && received >= min && received <= max;
        if (pass) {
            return {
                message: () => `expected ${received} not to be in range [${min}, ${max}]`,
                pass: true
            };
        }
        else {
            return {
                message: () => `expected ${received} to be in range [${min}, ${max}]`,
                pass: false
            };
        }
    }
});
// 测试工具函数
const createMockBluetoothDevice = (overrides = {}) => ({
    deviceId: 'mock-device-id',
    name: 'Mock Bluetooth Device',
    advertisData: {},
    RSSI: -50,
    advertisServiceUUIDs: [],
    ...overrides
});
exports.createMockBluetoothDevice = createMockBluetoothDevice;
const createMockPrinterConfig = (overrides = {}) => ({
    name: 'Mock Printer',
    type: 'thermal',
    connectionType: 'bluetooth',
    width: 58,
    ...overrides
});
exports.createMockPrinterConfig = createMockPrinterConfig;
const createMockPrintJob = (overrides = {}) => ({
    id: 'mock-job-id',
    data: { text: 'Test Print' },
    options: { copies: 1 },
    status: 'pending',
    createdAt: new Date(),
    ...overrides
});
exports.createMockPrintJob = createMockPrintJob;
const flushPromises = () => new Promise(resolve => setImmediate(resolve));
exports.flushPromises = flushPromises;
// 控制台输出过滤
const originalError = console.error;
beforeAll(() => {
    console.error = (...args) => {
        if (typeof args[0] === 'string' &&
            args[0].includes('Warning: ReactDOM.render is deprecated')) {
            return;
        }
        originalError.call(console, ...args);
    };
});
afterAll(() => {
    console.error = originalError;
});
// 全局清理
afterEach(() => {
    jest.clearAllMocks();
    localStorage.clear();
    sessionStorage.clear();
});
// 性能测试工具
const measureTime = async (fn) => {
    const start = performance.now();
    await fn();
    const end = performance.now();
    return end - start;
};
exports.measureTime = measureTime;
// 内存使用监控
const getMemoryUsage = () => {
    if (typeof performance !== 'undefined' && performance.memory) {
        return {
            used: performance.memory.usedJSHeapSize,
            total: performance.memory.totalJSHeapSize,
            limit: performance.memory.jsHeapSizeLimit
        };
    }
    return null;
};
exports.getMemoryUsage = getMemoryUsage;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL1VzZXJzL3pma2MvRGVza3RvcC8wMy3np7vliqjnq6/pobnnm64vdGFyby1ibHVldG9vdGgtcHJpbnQvdGVzdHMvc2V0dXAvamVzdC1zZXR1cC50cyIsIm1hcHBpbmdzIjoiO0FBQUE7O0dBRUc7OztBQUtILGFBQWE7QUFDYixJQUFJLENBQUMsSUFBSSxDQUFDLGNBQWMsRUFBRSxHQUFHLEVBQUUsQ0FBQyxDQUFDO0lBQy9CLFdBQVc7SUFDWCx3QkFBd0IsRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFO0lBQ25DLG9CQUFvQixFQUFFLElBQUksQ0FBQyxFQUFFLEVBQUU7SUFDL0IscUJBQXFCLEVBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRTtJQUNoQyw4QkFBOEIsRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFO0lBQ3pDLDZCQUE2QixFQUFFLElBQUksQ0FBQyxFQUFFLEVBQUU7SUFDeEMsbUJBQW1CLEVBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRTtJQUM5Qiw0QkFBNEIsRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFO0lBQ3ZDLG1CQUFtQixFQUFFLElBQUksQ0FBQyxFQUFFLEVBQUU7SUFDOUIsa0JBQWtCLEVBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRTtJQUM3QixvQkFBb0IsRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFO0lBQy9CLDJCQUEyQixFQUFFLElBQUksQ0FBQyxFQUFFLEVBQUU7SUFDdEMsMEJBQTBCLEVBQUUsSUFBSSxDQUFDLEVBQUUsRUFBRTtJQUNyQywyQkFBMkIsRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFO0lBQ3RDLGtDQUFrQyxFQUFFLElBQUksQ0FBQyxFQUFFLEVBQUU7SUFFN0MsV0FBVztJQUNYLGlCQUFpQixFQUFFLElBQUksQ0FBQyxFQUFFLENBQUMsR0FBRyxFQUFFLENBQUMsQ0FBQztRQUNoQyxRQUFRLEVBQUUsUUFBUTtRQUNsQixPQUFPLEVBQUUsT0FBTztRQUNoQixVQUFVLEVBQUUsT0FBTztRQUNuQixLQUFLLEVBQUUsV0FBVztRQUNsQixNQUFNLEVBQUUsVUFB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Q0QsT0FBTyxJQUFJLENBQUM7QUFDZCxDQUFDLENBQUM7QUFUVyxRQUFBLGNBQWMsa0JBU3pCIiwibmFtZXMiOltdLCJzb3VyY2VzIjpbIi9Vc2Vycy96ZmtjL0Rlc2t0b3AvMDMt56e75Yqo56uv6aG555uuL3Rhcm8tYmx1ZXRvb3RoLXByaW50L3Rlc3RzL3NldHVwL2plc3Qtc2V0dXAudHMiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBKZXN0IOWFqOWxgOiuvue9ruaWh+S7tlxuICovXG5cbi8vIOaJqeWxlSBKZXN0IOWMuemFjeWZqFxuaW1wb3J0ICdAdGVzdGluZy1saWJyYXJ5L2plc3QtZG9tJztcblxuLy8g5qih5oufIFRhcm8g546v5aKDXG5qZXN0Lm1vY2soJ0B0YXJvanMvdGFybycsICgpID0+ICh7XG4gIC8vIOiTneeJmeebuOWFsyBBUElcbiAgZ2V0Qmx1ZXRvb3RoQWRhcHRlclN0YXRlOiBqZXN0LmZuKCksXG4gIG9wZW5CbHVldG9vdGhBZGFwdGVyOiBqZXN0LmZuKCksXG4gIGNsb3NlQmx1ZXRvb3RoQWRhcHRlcjogamVzdC5mbigpLFxuICBzdGFydEJsdWV0b290aERldmljZXNEaXNjb3Zlcnk6IGplc3QuZm4oKSxcbiAgc3RvcEJsdWV0b290aERldmljZXNEaXNjb3Zlcnk6IGplc3QuZm4oKSxcbiAgZ2V0Qmx1ZXRvb3RoRGV2aWNlczogamVzdC5mbigpLFxuICBnZXRDb25uZWN0ZWRCbHVldG9vdGhEZXZpY2VzOiBqZXN0LmZuKCksXG4gIGNyZWF0ZUJMRUNvbm5lY3Rpb246IGplc3QuZm4oKSxcbiAgY2xvc2VCTEVDb25uZWN0aW9uOiBqZXN0LmZuKCksXG4gIGdldEJMRURldmljZVNlcnZpY2VzOiBqZXN0LmZuKCksXG4gIGdldEJMRURldmljZUNoYXJhY3RlcmlzdGljczogamVzdC5mbigpLFxuICByZWFkQkxFQ2hhcmFjdGVyaXN0aWNWYWx1ZTogamVzdC5mbigpLFxuICB3cml0ZUJMRUNoYXJhY3RlcmlzdGljVmFsdWU6IGplc3QuZm4oKSxcbiAgbm90aWZ5QkxFQ2hhcmFjdGVyaXN0aWNWYWx1ZUNoYW5nZTogamVzdC5mbigpLFxuXG4gIC8vIOiuvuWkh+ebuOWFsyBBUElcbiAgZ2V0U3lzdGVtSW5mb1N5bmM6IGplc3QuZm4oKCkgPT4gKHtcbiAgICBwbGF0Zm9ybTogJ3dlY2hhdCcsXG4gICAgdmVyc2lvbjogJzcuMC4wJyxcbiAgICBTREtWZXJzaW9uOiAnMi4wLjAnLFxuICAgIG1vZGVsOiAnaVBob25lIDEyJyxcbiAgICBzeXN0ZW06ICdpT1MgMTQuMCdcbiAgfSkpLFxuXG4gIC8vIOe9kee7nOebuOWFsyBBUElcbiAgcmVxdWVzdDogamVzdC5mbigpLFxuICB1cGxvYWRGaWxlOiBqZXN0LmZuKCksXG4gIGRvd25sb2FkRmlsZTogamVzdC5mbigpLFxuXG4gIC8vIOWtmOWCqOebuOWFsyBBUElcbiAgc2V0U3RvcmFnZVN5bmM6IGplc3QuZm4oKSxcbiAgZ2V0U3RvcmFnZVN5bmM6IGplc3QuZm4oKSxcbiAgcmVtb3ZlU3RvcmFnZVN5bmM6IGplc3QuZm4oKSxcbiAgY2xlYXJTdG9yYWdlU3luYzogamVzdC5mbigpLFxuXG4gIC8vIOeVjOmdouebuOWFsyBBUElcbiAgc2hvd1RvYXN0OiBqZXN0LmZuKCksXG4gIGhpZGVUb2FzdDogamVzdC5mbigpLFxuICBzaG93TG9hZGluZzogamVzdC5mbigpLFxuICBoaWRlTG9hZGluZzogamVzdC5mbigpLFxuICBzaG93TW9kYWw6IGplc3QuZm4oKSxcbiAgbmF2aWdhdGVUbzogamVzdC5mbigpLFxuICByZWRpcmVjdFRvOiBqZXN0LmZuKCksXG4gIG5hdmlnYXRlQmFjazogamVzdC5mbigpLFxuICBzd2l0Y2hUYWI6IGplc3QuZm4oKSxcbiAgcmVMYXVuY2g6IGplc3QuZm4oKSxcblxuICAvLyDkuovku7bnm7jlhbMgQVBJXG4gICRvbjogamVzdC5mbigpLFxuICAkb2ZmOiBqZXN0LmZuKCksXG4gICR0cmlnZ2VyOiBqZXN0LmZuKCksXG5cbiAgLy8g6Lev55Sx55u45YWzIEFQSVxuICBnZXRDdXJyZW50UGFnZXM6IGplc3QuZm4oKCkgPT4gW10pLFxuXG4gIC8vIOeOr+Wig+ebuOWFsyBBUElcbiAgRU5WX1RZUEU6IHtcbiAgICBXRUFQUDogJ1dFQVBQJyxcbiAgICBTV0FOOiAnU1dBTicsXG4gICAgQUxJUEFZOiAnQUxJUEFZJyxcbiAgICBUVDogJ1RUJyxcbiAgICBRUTogJ1FRJyxcbiAgICBKRDogJ0pEJ1xuICB9XG59KSk7XG5cbi8vIOaooeaLn+W+ruS/oeWwj+eoi+W6j+eOr+Wig1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KHdpbmRvdywgJ3d4Jywge1xuICB2YWx1ZToge1xuICAgIGdldEJsdWV0b290aEFkYXB0ZXJTdGF0ZTogamVzdC5mbigpLFxuICAgIG9wZW5CbHVldG9vdGhBZGFwdGVyOiBqZXN0LmZuKCksXG4gICAgY2xvc2VCbHVldG9vdGhBZGFwdGVyOiBqZXN0LmZuKCksXG4gICAgc3RhcnRCbHVldG9vdGhEZXZpY2VzRGlzY292ZXJ5OiBqZXN0LmZuKCksXG4gICAgc3RvcEJsdWV0b290aERldmljZXNEaXNjb3Zlcnk6IGplc3QuZm4oKSxcbiAgICBnZXRCbHVldG9vdGhEZXZpY2VzOiBqZXN0LmZuKCksXG4gICAgZ2V0Q29ubmVjdGVkQmx1ZXRvb3RoRGV2aWNlczogamVzdC5mbigpLFxuICAgIGNyZWF0ZUJMRUNvbm5lY3Rpb246IGplc3QuZm4oKSxcbiAgICBjbG9zZUJMRUNvbm5lY3Rpb246IGplc3QuZm4oKSxcbiAgICBnZXRCTEVEZXZpY2VTZXJ2aWNlczogamVzdC5mbigpLFxuICAgIGdldEJMRURldmljZUNoYXJhY3RlcmlzdGljczogamVzdC5mbigpLFxuICAgIHJlYWRCTEVDaGFyYWN0ZXJpc3RpY1ZhbHVlOiBqZXN0LmZuKCksXG4gICAgd3JpdGVCTEVDaGFyYWN0ZXJpc3RpY1ZhbHVlOiBqZXN0LmZuKCksXG4gICAgbm90aWZ5QkxFQ2hhcmFjdGVyaXN0aWNWYWx1ZUNoYW5nZTogamVzdC5mbigpLFxuICAgIGdldFN5c3RlbUluZm9TeW5jOiBqZXN0LmZuKCgpID0+ICh7XG4gICAgICBwbGF0Zm9ybTogJ3dlY2hhdCcsXG4gICAgICB2ZXJzaW9uOiAnNy4wLjAnXG4gICAgfSkpXG4gIH0sXG4gIHdyaXRhYmxlOiB0cnVlXG59KTtcblxuLy8g5YWo5bGA5rWL6K+V5bel5YW35Ye95pWwXG5kZWNsYXJlIGdsb2JhbCB7XG4gIG5hbWVzcGFjZSBqZXN0IHtcbiAgICBpbnRlcmZhY2UgTWF0Y2hlcnM8Uj4ge1xuICAgICAgdG9CZVZhbGlkQmx1ZXRvb3RoRGV2aWNlKCk6IFI7XG4gICAgICB0b0JlVmFsaWRQcmludGVyQ29uZmlnKCk6IFI7XG4gICAgICB0b0JlVmFsaWRQcmludEpvYigpOiBSO1xuICAgICAgdG9CZUluUmFuZ2UobWluOiBudW1iZXIsIG1heDogbnVtYmVyKTogUjtcbiAgICB9XG4gIH1cbn1cblxuLy8g6Ieq5a6a5LmJ5Yy56YWN5Zmo5a6e546wXG5leHBlY3QuZXh0ZW5kKHtcbiAgdG9CZVZhbGlkQmx1ZXRvb3RoRGV2aWNlKHJlY2VpdmVkKSB7XG4gICAgY29uc3QgcGFzcyA9IHJlY2VpdmVkICYmXG4gICAgICB0eXBlb2YgcmVjZWl2ZWQuZGV2aWNlSWQgPT09ICdzdHJpbmcnICYmXG4gICAgICB0eXBlb2YgcmVjZWl2ZWQubmFtZSA9PT0gJ3N0cmluZycgJiZcbiAgICAgIHR5cGVvZiByZWNlaXZlZC5hZHZlcnRpc0RhdGEgPT09ICdvYmplY3QnO1xuXG4gICAgaWYgKHBhc3MpIHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIG1lc3NhZ2U6ICgpID0+IGBleHBlY3RlZCAke3JlY2VpdmVkfSBub3QgdG8gYmUgYSB2YWxpZCBCbHVldG9vdGggZGV2aWNlYCxcbiAgICAgICAgcGFzczogdHJ1ZVxuICAgICAgfTtcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgbWVzc2FnZTogKCkgPT4gYGV4cGVjdGVkICR7cmVjZWl2ZWR9IHRvIGJlIGEgdmFsaWQgQmx1ZXRvb3RoIGRldmljZWAsXG4gICAgICAgIHBhc3M6IGZhbHNlXG4gICAgICB9O1xuICAgIH1cbiAgfSxcblxuICB0b0JlVmFsaWRQcmludGVyQ29uZmlnKHJlY2VpdmVkKSB7XG4gICAgY29uc3QgcGFzcyA9IHJlY2VpdmVkICYmXG4gICAgICB0eXBlb2YgcmVjZWl2ZWQubmFtZSA9PT0gJ3N0cmluZycgJiZcbiAgICAgIHR5cGVvZiByZWNlaXZlZC50eXBlID09PSAnc3RyaW5nJyAmJlxuICAgICAgdHlwZW9mIHJlY2VpdmVkLmNvbm5lY3Rpb25UeXBlID09PSAnc3RyaW5nJztcblxuICAgIGlmIChwYXNzKSB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICBtZXNzYWdlOiAoKSA9PiBgZXhwZWN0ZWQgJHtyZWNlaXZlZH0gbm90IHRvIGJlIGEgdmFsaWQgcHJpbnRlciBjb25maWdgLFxuICAgICAgICBwYXNzOiB0cnVlXG4gICAgICB9O1xuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICBtZXNzYWdlOiAoKSA9PiBgZXhwZWN0ZWQgJHtyZWNlaXZlZH0gdG8gYmUgYSB2YWxpZCBwcmludGVyIGNvbmZpZ2AsXG4gICAgICAgIHBhc3M6IGZhbHNlXG4gICAgICB9O1xuICAgIH1cbiAgfSxcblxuICB0b0JlVmFsaWRQcmludEpvYihyZWNlaXZlZCkge1xuICAgIGNvbnN0IHBhc3MgPSByZWNlaXZlZCAmJlxuICAgICAgdHlwZW9mIHJlY2VpdmVkLmlkID09PSAnc3RyaW5nJyAmJlxuICAgICAgdHlwZW9mIHJlY2VpdmVkLmRhdGEgPT09ICdvYmplY3QnICYmXG4gICAgICB0eXBlb2YgcmVjZWl2ZWQub3B0aW9ucyA9PT0gJ29iamVjdCc7XG5cbiAgICBpZiAocGFzcykge1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgbWVzc2FnZTogKCkgPT4gYGV4cGVjdGVkICR7cmVjZWl2ZWR9IG5vdCB0byBiZSBhIHZhbGlkIHByaW50IGpvYmAsXG4gICAgICAgIHBhc3M6IHRydWVcbiAgICAgIH07XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIG1lc3NhZ2U6ICgpID0+IGBleHBlY3RlZCAke3JlY2VpdmVkfSB0byBiZSBhIHZhbGlkIHByaW50IGpvYmAsXG4gICAgICAgIHBhc3M6IGZhbHNlXG4gICAgICB9O1xuICAgIH1cbiAgfSxcblxuICB0b0JlSW5SYW5nZShyZWNlaXZlZDogbnVtYmVyLCBtaW46IG51bWJlciwgbWF4OiBudW1iZXIpIHtcbiAgICBjb25zdCBwYXNzID0gdHlwZW9mIHJlY2VpdmVkID09PSAnbnVtYmVyJyAmJiByZWNlaXZlZCA+PSBtaW4gJiYgcmVjZWl2ZWQgPD0gbWF4O1xuXG4gICAgaWYgKHBhc3MpIHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIG1lc3NhZ2U6ICgpID0+IGBleHBlY3RlZCAke3JlY2VpdmVkfSBub3QgdG8gYmUgaW4gcmFuZ2UgWyR7bWlufSwgJHttYXh9XWAsXG4gICAgICAgIHBhc3M6IHRydWVcbiAgICAgIH07XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIG1lc3NhZ2U6ICgpID0+IGBleHBlY3RlZCAke3JlY2VpdmVkfSB0byBiZSBpbiByYW5nZSBbJHttaW59LCAke21heH1dYCxcbiAgICAgICAgcGFzczogZmFsc2VcbiAgICAgIH07XG4gICAgfVxuICB9XG59KTtcblxuLy8g5rWL6K+V5bel5YW35Ye95pWwXG5leHBvcnQgY29uc3QgY3JlYXRlTW9ja0JsdWV0b290aERldmljZSA9IChvdmVycmlkZXMgPSB7fSkgPT4gKHtcbiAgZGV2aWNlSWQ6ICdtb2NrLWRldmljZS1pZCcsXG4gIG5hbWU6ICdNb2NrIEJsdWV0b290aCBEZXZpY2UnLFxuICBhZHZlcnRpc0RhdGE6IHt9LFxuICBSU1NJOiAtNTAsXG4gIGFkdmVydGlzU2VydmljZVVVSURzOiBbXSxcbiAgLi4ub3ZlcnJpZGVzXG59KTtcblxuZXhwb3J0IGNvbnN0IGNyZWF0ZU1vY2tQcmludGVyQ29uZmlnID0gKG92ZXJyaWRlcyA9IHt9KSA9PiAoe1xuICBuYW1lOiAnTW9jayBQcmludGVyJyxcbiAgdHlwZTogJ3RoZXJtYWwnLFxuICBjb25uZWN0aW9uVHlwZTogJ2JsdWV0b290aCcsXG4gIHdpZHRoOiA1OCxcbiAgLi4ub3ZlcnJpZGVzXG59KTtcblxuZXhwb3J0IGNvbnN0IGNyZWF0ZU1vY2tQcmludEpvYiA9IChvdmVycmlkZXMgPSB7fSkgPT4gKHtcbiAgaWQ6ICdtb2NrLWpvYi1pZCcsXG4gIGRhdGE6IHsgdGV4dDogJ1Rlc3QgUHJpbnQnIH0sXG4gIG9wdGlvbnM6IHsgY29waWVzOiAxIH0sXG4gIHN0YXR1czogJ3BlbmRpbmcnLFxuICBjcmVhdGVkQXQ6IG5ldyBEYXRlKCksXG4gIC4uLm92ZXJyaWRlc1xufSk7XG5cbmV4cG9ydCBjb25zdCBmbHVzaFByb21pc2VzID0gKCkgPT4gbmV3IFByb21pc2UocmVzb2x2ZSA9PiBzZXRJbW1lZGlhdGUocmVzb2x2ZSkpO1xuXG4vLyDmjqfliLblj7DovpPlh7rov4fmu6RcbmNvbnN0IG9yaWdpbmFsRXJyb3IgPSBjb25zb2xlLmVycm9yO1xuYmVmb3JlQWxsKCgpID0+IHtcbiAgY29uc29sZS5lcnJvciA9ICguLi5hcmdzOiBhbnlbXSkgPT4ge1xuICAgIGlmIChcbiAgICAgIHR5cGVvZiBhcmdzWzBdID09PSAnc3RyaW5nJyAmJlxuICAgICAgYXJnc1swXS5pbmNsdWRlcygnV2FybmluZzogUmVhY3RET00ucmVuZGVyIGlzIGRlcHJlY2F0ZWQnKVxuICAgICkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBvcmlnaW5hbEVycm9yLmNhbGwoY29uc29sZSwgLi4uYXJncyk7XG4gIH07XG59KTtcblxuYWZ0ZXJBbGwoKCkgPT4ge1xuICBjb25zb2xlLmVycm9yID0gb3JpZ2luYWxFcnJvcjtcbn0pO1xuXG4vLyDlhajlsYDmuIXnkIZcbmFmdGVyRWFjaCgoKSA9PiB7XG4gIGplc3QuY2xlYXJBbGxNb2NrcygpO1xuICBsb2NhbFN0b3JhZ2UuY2xlYXIoKTtcbiAgc2Vzc2lvblN0b3JhZ2UuY2xlYXIoKTtcbn0pO1xuXG4vLyDmgKfog73mtYvor5Xlt6XlhbdcbmV4cG9ydCBjb25zdCBtZWFzdXJlVGltZSA9IGFzeW5jIChmbjogKCkgPT4gUHJvbWlzZTx2b2lkPiB8IHZvaWQpID0+IHtcbiAgY29uc3Qgc3RhcnQgPSBwZXJmb3JtYW5jZS5ub3coKTtcbiAgYXdhaXQgZm4oKTtcbiAgY29uc3QgZW5kID0gcGVyZm9ybWFuY2Uubm93KCk7XG4gIHJldHVybiBlbmQgLSBzdGFydDtcbn07XG5cbi8vIOWGheWtmOS9v+eUqOebkeaOp1xuZXhwb3J0IGNvbnN0IGdldE1lbW9yeVVzYWdlID0gKCkgPT4ge1xuICBpZiAodHlwZW9mIHBlcmZvcm1hbmNlICE9PSAndW5kZWZpbmVkJyAmJiBwZXJmb3JtYW5jZS5tZW1vcnkpIHtcbiAgICByZXR1cm4ge1xuICAgICAgdXNlZDogcGVyZm9ybWFuY2UubWVtb3J5LnVzZWRKU0hlYXBTaXplLFxuICAgICAgdG90YWw6IHBlcmZvcm1hbmNlLm1lbW9yeS50b3RhbEpTSGVhcFNpemUsXG4gICAgICBsaW1pdDogcGVyZm9ybWFuY2UubWVtb3J5LmpzSGVhcFNpemVMaW1pdFxuICAgIH07XG4gIH1cbiAgcmV0dXJuIG51bGw7XG59OyJdLCJ2ZXJzaW9uIjozfQ==